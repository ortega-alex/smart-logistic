import{r,j as e,O as _}from"./index-BsevUT63.js";import{s as u,B as p,I}from"./method-http.utility-B7fMRS9C.js";import{M as N,a as k,b as A,E,h as L}from"./crane.service-B54xrd-k.js";import{S as O}from"./Search-C3qyFsaw.js";import{h as T}from"./aution.service-BFCasV5O.js";import{F as i,I as F}from"./index-CmvJS-Fk.js";import{S as v,L as M,F as G,M as $}from"./Table-Dl81tnez.js";import{T as B}from"./index-De_90GVn.js";import{S as q}from"./index-B3J4vvSr.js";import"./Private-CllHzfI3.js";const z=({crane:n,onClose:l})=>{const[m,h]=r.useState([]),[d,c]=r.useState(!1),g=async a=>{try{c(!0);let o;n.id_grua>0?o=await k({...n,...a}):o=await A(a),o.message?u.warning(o.message):(u.success(`Grua ${n.id_grua>0?"editada":"agregada"} correctamente`),l())}catch(o){u.error(`Error http add crane: ${o.message}`)}finally{c(!1)}};return r.useEffect(()=>{T().then(a=>h(a)).catch(a=>u.error(`Error http get autions: ${a.message}`))},[]),e.jsxs(i,{layout:"vertical",initialValues:n,onFinish:g,children:[e.jsx(i.Item,{label:"Nombre",name:"grua",rules:[{required:!0,message:"El campo es obligatorio"}],children:e.jsx(F,{placeholder:"Ingrese el nombre"})}),e.jsx(i.Item,{label:"Subasta (Opcional)",name:"id_subasta",children:e.jsx(v,{allowClear:!0,className:"w-100",placeholder:"Seleccione una opción",options:m.filter(a=>a.estado).map(a=>({value:a.id_subasta,label:a.subasta}))})}),e.jsx(i.Item,{label:"Costo",name:"costo",rules:[{required:!0,message:"El campo es obligatorio"}],children:e.jsx(B,{className:"w-100",addonBefore:e.jsx(i.Item,{name:"moneda",style:{margin:0,padding:0,width:80},children:e.jsx(v,{className:"w-100",options:Object.keys(N).map(a=>({value:a,label:N[a]}))})}),min:0,placeholder:"Ingrese un costo"})}),e.jsx(i.Item,{name:"estado",label:"Estado",valuePropName:"checked",children:e.jsx(q,{checkedChildren:"Activo",unCheckedChildren:"Inactivo"})}),e.jsx("div",{className:"text-right",children:e.jsx(p,{type:"primary",htmlType:"submit",loading:d,disabled:d,children:"Enviar"})})]})},X=()=>{const n=_(s=>s.device),l="Gruas",[m,h]=r.useState(E),[d,c]=r.useState([]),[g,a]=r.useState([]),[o,x]=r.useState(!1),[j,f]=r.useState(!1),C=s=>{let t=[...g];s.trim()!==""&&(t=t.filter(b=>{var w;return b.id_grua===Number(s)||b.grua.toLowerCase().indexOf(s.toLowerCase())!==-1||((w=b.subasta)==null?void 0:w.subasta.toLowerCase().indexOf(s.toLowerCase()))!==-1})),c(t)},y=s=>{var t;h({...s,id_subasta:(t=s.subasta)==null?void 0:t.id_subasta}),x(!0)},S=()=>{f(!0),L().then(s=>{c(s),a(s)}).catch(s=>u.error(`Error http get cranes: ${s.message}`)).finally(()=>f(!1))};return r.useEffect(()=>{S()},[]),e.jsxs("div",{className:"h-100 flex flex-column p-3",children:[e.jsxs("div",{className:"flex flex-md-column gap-3 justify-between",children:[e.jsx("h3",{children:l}),e.jsx("div",{children:e.jsx(O,{onSearch:C,onReset:()=>C("")})}),e.jsx(p,{type:"primary",htmlType:"button",onClick:()=>{h(E),x(!0)},children:"Agregar"})]}),n?e.jsx(M,{dataSource:d,loading:j,renderItem:s=>{var t;return e.jsxs("div",{className:"item-list",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Nombre: "})," ",s.grua]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Subasta: "})," ",(t=s.subasta)==null?void 0:t.subasta]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Estado: "})," ",s.estado?"Activo":"Inactivo"]}),e.jsx(p,{type:"link",danger:!0,htmlType:"button",icon:e.jsx(I.Edit,{}),onClick:()=>y(s),children:"Editar"})]})]},s.id_subasta)}}):e.jsx(G,{size:"small",rowClassName:(s,t)=>t%2===0?"table-row-light":"table-row-dark",pagination:!1,className:"table",loading:j,showSorterTooltip:!1,rowKey:"id_grua",dataSource:d,columns:[{title:"No",dataIndex:"id_grua"},{title:"Nombre",dataIndex:"grua",ellipsis:!0,sorter:!0},{title:"Subasta",dataIndex:"subasta",ellipsis:!0,sorter:!0,render:s=>e.jsx("span",{children:s==null?void 0:s.subasta})},{title:"Estado",dataIndex:"estado",render:s=>e.jsx("span",{className:s?"text-success":"text-danger",children:s?"Actuvi":"Inactivo"})},{title:"Opciones",dataIndex:"operacion",width:80,render:(s,t)=>e.jsx("div",{className:"text-center",children:e.jsx(p,{style:{width:40},icon:e.jsx(I.Edit,{}),type:"primary",size:"small",onClick:()=>y(t)})})}]}),e.jsx($,{open:o,title:e.jsxs("h3",{children:[m.id_grua>0?"Editar":"Agregar"," ",l.substring(0,l.length-1)]}),footer:null,onCancel:()=>x(!1),centered:!0,destroyOnClose:!0,children:e.jsx(z,{crane:m,onClose:()=>{S(),x(!1)}})})]})};export{X as Crane};
