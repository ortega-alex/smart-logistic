import{r as o,j as e,q as y}from"./index-fBuO0l8w.js";import{s as b,B as x,I as N}from"./method-http.utility-CM8CHeIw.js";import{c as E,d as S,e as v}from"./user.service-BOcMb7XX.js";import{V as f}from"./Utilityes.d-EXBqBskY.js";import{p as _,m as C}from"./Private-DSJudlqf.js";import{h as U}from"./profile.service-BwObWhY-.js";import{F as n}from"./index-CCcnvYN1.js";import{I as h}from"./index-BKdQ44jl.js";import{S as k,F as P}from"./Table-CYsj1JvR.js";import{S as T}from"./index-CWLbX5eI.js";import{L as q}from"./index-O_xYGJnl.js";import{M as A}from"./index-CfEI7y9b.js";import"./Notification-BI9cwgRy.js";import"./row-BIFJ6Q4x.js";import"./DownOutlined-CODLCnfK.js";import"./fade-R8mJI5-o.js";const w={id_usuario:0,correo:"",estado:!0,nombre:"",telefono:"",usuario:""},F=({user:d,onClose:c})=>{const[p,j]=o.useState([]),[m,u]=o.useState(!1),g=async r=>{try{u(!0);let t;d.id_usuario>0?t=await E({...d,...r}):t=await S(r),t.message?b.warning(t.message):c()}catch(t){b.error(`Error http add user: ${t.message}`)}finally{u(!1)}},l=async(r,t)=>{let i=null;if(t&&t.trim()===""?i="El campo es obligatorio":r===f.PhoneNumber?i=await _(t):r===f.Mail&&(i=await C(t)),i)throw new Error(i)};return o.useEffect(()=>{U().then(r=>j(r)).catch(r=>b.error(`Erro http get profiles: ${r.message}`))},[]),e.jsxs(n,{layout:"vertical",initialValues:d,onFinish:g,children:[e.jsx(n.Item,{label:"Nombre completo",name:"nombre",rules:[{required:!0,message:"El campo es obligatorio"}],children:e.jsx(h,{placeholder:"Ingrese el nombre"})}),e.jsx(n.Item,{label:"Tipo de perfil",name:"id_perfil",rules:[{required:!0,message:"El campo es obligatorio"}],children:e.jsx(k,{className:"w-100",placeholder:"Seleccione una opción",options:p.filter(r=>r.estado).map(r=>({value:r.id_perfil,label:r.perfil}))})}),e.jsx(n.Item,{label:"Teléfono",name:"telefono",className:"flex-1",rules:[{required:!0,validator:(r,t)=>l(f.PhoneNumber,t)}],children:e.jsx(h,{placeholder:"Ingrese un número de teléfono"})}),e.jsx(n.Item,{label:"Correo",name:"correo",className:"flex-1",rules:[{required:!0,validator:(r,t)=>l(f.Mail,t)}],children:e.jsx(h,{placeholder:"Ingrese un email"})}),e.jsx(n.Item,{label:"Usuario",name:"usuario",className:"flex-1",rules:[{required:!0,message:"El campo es obligatorio"}],children:e.jsx(h,{placeholder:"Ingrese un usuario",disabled:d.id_usuario>0})}),e.jsx(n.Item,{name:"estado",label:"Estado",valuePropName:"checked",children:e.jsx(T,{checkedChildren:"Activo",unCheckedChildren:"Inactivo"})}),e.jsx("div",{className:"text-right",children:e.jsx(x,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Enviar"})})]})},Y=()=>{const d=y(s=>s.device),c="Usuarios",[p,j]=o.useState([]),[m,u]=o.useState(w),[g,l]=o.useState(!1),[r,t]=o.useState(!1),i=()=>{t(!0),v().then(s=>j(s)).catch(s=>`Error http get users: ${s.message}`).finally(()=>t(!1))},I=s=>{var a;u({...s,id_perfil:(a=s.perfil)==null?void 0:a.id_perfil}),l(!0)};return o.useEffect(()=>{i()},[]),e.jsxs("div",{className:"h-100 flex flex-column p-3",children:[e.jsxs("div",{className:"flex flex-md-column gap-3 justify-between",children:[e.jsx("h3",{children:c}),e.jsx("div",{children:e.jsx(h.Search,{placeholder:"Buscar",onSearch:()=>{},enterButton:!0})}),e.jsx(x,{type:"primary",htmlType:"button",onClick:()=>{u(w),l(!0)},children:"Agregar"})]}),d?e.jsx(q,{dataSource:p,renderItem:s=>{var a;return e.jsxs("div",{className:"item-list",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Nombre: "})," ",s.nombre]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Perfil: "})," ",(a=s.perfil)==null?void 0:a.perfil]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Usuario: "})," ",s.usuario]})]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Estado: "})," ",s.estado?"Activo":"Inactivo"]}),e.jsx(x,{type:"link",danger:!0,htmlType:"button",icon:e.jsx(N.Edit,{}),onClick:()=>I(s),children:"Editar"})]})]},s.id_usuario)}}):e.jsx(P,{size:"small",rowClassName:(s,a)=>a%2===0?"table-row-light":"table-row-dark",pagination:{position:["none","bottomRight"],showSizeChanger:!0,pageSizeOptions:[50,100,250,500]},className:"table",loading:r,showSorterTooltip:!1,rowKey:"id_usuario",dataSource:p,columns:[{title:"No",dataIndex:"id_usuario"},{title:"Nombre",dataIndex:"nombre",ellipsis:!0,sorter:!0},{title:"Perfil",dataIndex:"perfil",ellipsis:!0,sorter:!0,render:s=>e.jsx("span",{children:s==null?void 0:s.perfil})},{title:"Usuario",dataIndex:"usuario",sorter:!0},{title:"Estado",dataIndex:"estado",render:s=>e.jsx("span",{className:s?"text-success":"text-danger",children:s?"Actuvi":"Inactivo"})},{title:"Opciones",dataIndex:"operacion",width:80,render:(s,a)=>e.jsx("div",{className:"text-center",children:e.jsx(x,{style:{width:40},icon:e.jsx(N.Edit,{}),type:"primary",size:"small",onClick:()=>I(a)})})}]}),e.jsx(A,{open:g,title:e.jsxs("h3",{children:[m.id_usuario>0?"Editar":"Agregar"," ",c.substring(0,c.length-1)]}),footer:null,onCancel:()=>l(!1),centered:!0,destroyOnClose:!0,children:e.jsx(F,{user:m,onClose:()=>{i(),l(!1)}})})]})};export{Y as User};
