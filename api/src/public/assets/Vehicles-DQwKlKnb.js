import{j as e,r,v as L,c as P,a as B,p as H,b as k}from"./index-DeRs25tb.js";import{T as R,B as g,I as N}from"./Icon-ZCyfFCep.js";import{E as K}from"./Vehicles-De_A1J7k.js";import{S as Q}from"./Search-DWezstAv.js";import{c as J,g as $}from"./format.utility-DkVYUxV5.js";import{a as W}from"./fuctions.utility-D0ENTGxM.js";import{a as q}from"./customer.service-C0Zt9a2E.js";import{h as X,a as Z}from"./vehicles.service-M8jK2tQK.js";import{E as O,V as ee}from"./ViewFiles-DzOlCPbT.js";import{M as D}from"./Utilityes.d-EXBqBskY.js";import{F as M,S as te}from"./Table-B2h2cI4i.js";import{D as u}from"./index-jHC0o-m8.js";import{T as A}from"./index-DNoYEB46.js";import{M as U}from"./index-CWRTqrJg.js";import{s as j}from"./method-http.utility-CuofCWHh.js";import{L as se}from"./index-JgT2oeId.js";import"./index-gyB3Elxo.js";import"./Private-Bb13mkBg.js";import"./row-Dx3yH235.js";const G=({detail:l})=>e.jsx(M,{size:"small",rowClassName:(m,d)=>d%2===0?"table-row-light":"table-row-dark",pagination:!1,className:"table mb-3 px-5",showSorterTooltip:!1,rowKey:"id_subasta",dataSource:l,columns:[{title:"Concepto",dataIndex:"nombre",ellipsis:!0},{width:200,title:"Valor",render:(m,{moneda:d,valor:f})=>e.jsxs("span",{children:[d,". ",J(f)]})}]}),le=({vehicle:l})=>{var v,n,_,h,I,a,w,b,p,z,y,x,T,E;const[m,d]=r.useState(!1),[f,S]=r.useState(O),C=i=>{S({...f,ruta:i}),d(!0)};return e.jsxs("div",{className:"flex flex-column",children:[e.jsxs("div",{className:"flex flex-row gap-3 mb-3",children:[e.jsxs("div",{className:"flex flex-column flex-1 gap-2 px-3",children:[e.jsx(u,{orientation:"left",children:"Informacion del cliente"}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Cliente:"})," ",(v=l.cotizacion.cliente)==null?void 0:v.cliente]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono Fijo:"})," ",(n=l.cotizacion.cliente)==null?void 0:n.telefono_fijo]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono Celular:"})," ",(_=l.cotizacion.cliente)==null?void 0:_.telefono_celular]})]}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Direccion:"})," ",(h=l.cotizacion.cliente)==null?void 0:h.direccion]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. NIT:"})," ",(I=l.cotizacion.cliente)==null?void 0:I.nit]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. DPI:"})," ",(a=l.cotizacion.cliente)==null?void 0:a.dpi]})]}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Correo:"})," ",(w=l.cotizacion.cliente)==null?void 0:w.correo]})]}),e.jsxs("div",{className:"flex flex-column flex-1 gap-2",children:[e.jsx(u,{orientation:"left",children:"Informacion del vehiculo"}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. VIN:"})," ",l.cotizacion.vin]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. Lote:"})," ",l.cotizacion.lote]})]}),e.jsxs("div",{className:"flex  flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Tipo de vehiculo:"})," ",(b=l.cotizacion.tipo_veniculo)==null?void 0:b.tipo_vehiculo]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Marca y modelo:"})," ",l.cotizacion.marca," - ",l.cotizacion.modelo]})]}),e.jsx(u,{orientation:"left",children:"Informacion del vendedor"}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Nombre:"})," ",(p=l.cotizacion.vendedor)==null?void 0:p.nombre]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono:"})," ",(z=l.cotizacion.vendedor)==null?void 0:z.telefono]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Correo:"})," ",(y=l.cotizacion.vendedor)==null?void 0:y.correo]})]})]})]}),((x=l.cotizacion.detalles)==null?void 0:x.some(i=>i.moneda===D.USD))&&e.jsxs(e.Fragment,{children:[e.jsx(u,{orientation:"left",children:"Detalle en USD"}),e.jsx(G,{detail:l.cotizacion.detalles.filter(i=>i.moneda===D.USD)??[]})]}),((T=l.cotizacion.detalles)==null?void 0:T.some(i=>i.moneda===D.GTQ))&&e.jsxs(e.Fragment,{children:[e.jsx(u,{orientation:"left",children:"Detalle en GTQ"}),e.jsx(G,{detail:((E=l.cotizacion.detalles)==null?void 0:E.filter(i=>i.moneda===D.GTQ))??[]})]}),e.jsx(u,{orientation:"left",children:"Historico"}),e.jsx(M,{size:"small",rowClassName:(i,V)=>V%2===0?"table-row-light":"table-row-dark",pagination:!1,className:"table mb-3 px-5",showSorterTooltip:!1,rowKey:"id_subasta",dataSource:l.historial_vechiculo,columns:[{title:"Fecha",dataIndex:"fecha_creacion",render:i=>e.jsx("span",{children:$(i,"DD/MM/YYYY")})},{title:"Descripcion",dataIndex:"descripcion",ellipsis:!0},{title:"Visible por el cliente",dataIndex:"visible_cliente",align:"center",render:i=>e.jsx(A,{color:i?"green":"red",children:i?"Si":"No"})},{title:"archivo",dataIndex:"archivo",render:i=>e.jsx("div",{className:"text-center",children:e.jsx(R,{title:"Ver",children:e.jsx(g,{type:"link",icon:e.jsx(N.Eye,{}),onClick:()=>C(i)})})})}]}),e.jsx(U,{open:m,onCancel:()=>{d(!1),S(O)},centered:!0,destroyOnClose:!0,closeIcon:e.jsx(N.Close,{color:"white"}),width:1e3,footer:!1,className:"bg-transparent",children:e.jsx(ee,{file:f,download:!0})})]})},Se=()=>{const l=L(t=>t.device),{lote:m}=P(),d=B(),[f,S]=r.useState([]),[C,v]=r.useState([]),[n,_]=r.useState(K),[h,I]=r.useState({data:!1,services:!1}),[a,w]=r.useState({pagination:{current:1,pageSize:250}}),[b,p]=r.useState(""),[z,y]=r.useState(!1),x=(t,s)=>I({...h,[t]:s}),T=(t,s,o)=>{var c;w({pagination:t,filters:s,sortOrder:Array.isArray(o)?void 0:o.order,sortField:Array.isArray(o)?void 0:o.field}),t.pageSize!==((c=a.pagination)==null?void 0:c.pageSize)&&v([])},E=async()=>{var t,s,o;try{if(!((t=n.cotizacion.cliente)!=null&&t.correo))return j.warning("El cliente no cuenta con correo, por favor edite el cliente antes de generar la url");const c={id:(s=n.cotizacion.cliente)==null?void 0:s.id_cliente,correo:(o=n.cotizacion.cliente)==null?void 0:o.correo},F=window.btoa(JSON.stringify(c)),Y=`${window.location.href.split("#")[0]}#/${H.SING_IN_CUSTOMER}/${F}`;await W(Y),j.success("Copiado el url al portapapeles")}catch(c){j.error(`Ha ocurrido un error: ${c}`)}},i=t=>{x("services",!0),X(t).then(s=>{_(s),y(!0)}).catch(s=>j.error(`Error http get vehicles: ${s.message}`)).finally(()=>x("services",!1))},V=()=>{var t,s;x("data",!0),Z({...a,current:(t=a.pagination)==null?void 0:t.current,pageSize:(s=a.pagination)==null?void 0:s.pageSize,filter:b,sortOrder:a.sortOrder==="descend"?"DESC":"ASC"}).then(o=>{if(v(o.data),w({...a,pagination:{...a.pagination,total:o.total}}),m){const c=o.data.find(F=>F.cotizacion.lote===m);c&&i(c.id_vehiculo),d(`/${k.PRIVATE}/${k.VEHICLES}`,{replace:!0})}}).catch(o=>j.error(`Error http get vehicles: ${o.message}`)).finally(()=>x("data",!1))};return r.useEffect(()=>{q().then(t=>S(t==null?void 0:t.filter(s=>s.estado))).catch(t=>j.error(`Error http get customers: ${t.message}}`))},[]),r.useEffect(()=>{V()},[JSON.stringify(a),b]),e.jsxs("div",{className:"h-100 flex flex-column p-3",children:[e.jsxs("div",{className:"flex flex-md-column gap-3 justify-between items-end mb-3",children:[e.jsxs("div",{className:"flex flex-column w-md-100",children:[e.jsx("label",{htmlFor:"cliente",children:"Cliente"}),e.jsx(te,{placeholder:"Selecciones una opción",options:f.filter(t=>t.estado).map(t=>({label:t.cliente,value:t.id_cliente})),onChange:t=>p(t),allowClear:!0,style:{minWidth:200}})]}),e.jsxs("div",{className:"flex flex-row gap-2 items-center w-md-100",children:[e.jsx(R,{title:"Recargar",children:e.jsx(g,{type:"text",htmlType:"button",icon:e.jsx(N.Reload,{}),onClick:()=>V()})}),e.jsx(Q,{onSearch:t=>p(t),onReset:()=>p("")})]}),e.jsx(g,{type:"primary",htmlType:"button",onClick:()=>{},className:"w-md-100",children:"Agregar"})]}),l?e.jsx(se,{dataSource:C,loading:h.data,renderItem:t=>{var s,o;return e.jsxs("div",{className:"item-list",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Cliente: "})," ",(s=t.cotizacion.cliente)==null?void 0:s.cliente]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Vendedor: "})," ",(o=t.cotizacion.vendedor)==null?void 0:o.nombre]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Estado: "})," ",t.estado?"Activo":"Inactivo"]}),e.jsx(g,{type:"link",danger:!0,htmlType:"button",icon:e.jsx(N.Edit,{}),onClick:()=>i(t.id_vehiculo),children:"Editar"})]})]},t.id_vehiculo)}}):e.jsx(M,{size:"small",rowClassName:(t,s)=>s%2===0?"table-row-light":"table-row-dark",pagination:{position:["none","bottomRight"],...a.pagination,showSizeChanger:!0,pageSizeOptions:[50,100,250,500]},onChange:T,className:"table",loading:h.data,showSorterTooltip:!1,rowKey:"id_vehiculo",dataSource:C,columns:[{title:"No",dataIndex:"id_vehiculo",sorter:!0},{title:"Fecha",dataIndex:"fecha_creacion",ellipsis:!0,sorter:!0,render:t=>e.jsx("span",{children:$(t,"DD/MM/YYYY")})},{title:"Loter",dataIndex:"lote",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>e.jsx("span",{children:s==null?void 0:s.lote})},{title:"Vendedor",dataIndex:"vendedor",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>{var o;return e.jsx("span",{children:(o=s==null?void 0:s.vendedor)==null?void 0:o.nombre})}},{title:"Cliente",dataIndex:"cliente",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>{var o;return e.jsx("span",{children:(o=s==null?void 0:s.cliente)==null?void 0:o.cliente})}},{title:"Marca y Modelo",dataIndex:"cotizacion",ellipsis:!0,render:t=>e.jsxs("span",{children:[t.marca," - ",t.modelo]})},{title:"Estado",dataIndex:"estado_importacion",sorter:!0,render:t=>e.jsx("span",{children:t.estado_importacion})},{title:"Opciones",dataIndex:"operacion",width:80,render:(t,s)=>e.jsx(g,{style:{width:40},icon:e.jsx(N.Edit,{}),type:"text",size:"small",onClick:()=>i(s.id_vehiculo),children:"Ver"})}]}),e.jsx(U,{open:z,title:e.jsxs("h3",{children:["Vehiculo ",e.jsx(A,{color:n.estado_importacion.color,children:n.estado_importacion.estado_importacion})]}),footer:()=>e.jsx("div",{className:"flex  flex-row gap-3 justify-end",children:e.jsx(g,{type:"link",icon:e.jsx(N.Copy,{}),onClick:E,children:"Url Cliente"})}),onCancel:()=>y(!1),centered:!0,destroyOnClose:!0,width:1200,children:e.jsx(le,{vehicle:n})})]})};export{Se as Vehicles};
