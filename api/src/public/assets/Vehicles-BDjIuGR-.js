import{j as e,O as G,aF as R,a as $,r,p as T}from"./index-DUTae07C.js";import{N as D,s as _,T as L,B as w,I as C}from"./method-http.utility-DTRIZLiH.js";import{a as P,D as c,T as k}from"./index-BabMYYNb.js";import{S as Y}from"./Search-BFt35SwB.js";import{c as z,g as B}from"./format.utility-D1koD93K.js";import{h as Q}from"./customer.service-BXoTG7B1.js";import{M as V}from"./Utilityes.d-EXBqBskY.js";import{S as U,L as H,F as q,M as J}from"./Table-DFuZ754j.js";import"./Private-XhUdaezg.js";import"./index-DmcKSry_.js";const K={id_estado_importacion:0,estado_importacion:"",estado:!0},W={id_vehiculo:0,lote:"",cotizacion:P,estado_importacion:K,historial_vechiculo:[],estado:!0},M="/vehicles",X=async a=>await D({path:`${M}/pagination`,method:"POST",data:a}),Z=async a=>await D({path:`${M}/${a}`,method:"GET"}),ee=({vehicle:a})=>{var d,u,g,N,x,h,m,v,o,b,n,f,j;return e.jsxs("div",{className:"flex flex-column",children:[e.jsxs("div",{className:"flex flex-row gap-3 mb-3",children:[e.jsxs("div",{className:"flex flex-column flex-1 gap-2 px-3",children:[e.jsx(c,{orientation:"left",children:"Informacion del cliente"}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Cliente:"})," ",(d=a.cotizacion.cliente)==null?void 0:d.cliente]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono Fijo:"})," ",(u=a.cotizacion.cliente)==null?void 0:u.telefono_fijo]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono Celular:"})," ",(g=a.cotizacion.cliente)==null?void 0:g.telefono_celular]})]}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Direccion:"})," ",(N=a.cotizacion.cliente)==null?void 0:N.direccion]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. NIT:"})," ",(x=a.cotizacion.cliente)==null?void 0:x.nit]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. DPI:"})," ",(h=a.cotizacion.cliente)==null?void 0:h.dpi]})]}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Correo:"})," ",(m=a.cotizacion.cliente)==null?void 0:m.correo]})]}),e.jsxs("div",{className:"flex flex-column flex-1 gap-2",children:[e.jsx(c,{orientation:"left",children:"Informacion del vehiculo"}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. VIN:"})," ",a.cotizacion.vin]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"No. Lote:"})," ",a.cotizacion.lote]})]}),e.jsxs("div",{className:"flex  flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Tipo de vehiculo:"})," ",(v=a.cotizacion.tipo_veniculo)==null?void 0:v.tipo_vehiculo]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Marca y modelo:"})," ",a.cotizacion.marca," - ",a.cotizacion.modelo]})]}),e.jsx(c,{orientation:"left",children:"Informacion del vendedor"}),e.jsxs("div",{className:"flex flex-column",children:[e.jsx("strong",{children:"Nombre:"})," ",(o=a.cotizacion.vendedor)==null?void 0:o.nombre]}),e.jsxs("div",{className:"flex flex-row gap-3 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Telefono:"})," ",(b=a.cotizacion.vendedor)==null?void 0:b.telefono]}),e.jsxs("div",{className:"flex flex-1 flex-column",children:[e.jsx("strong",{children:"Correo:"})," ",(n=a.cotizacion.vendedor)==null?void 0:n.correo]})]})]})]}),e.jsx(c,{orientation:"left",children:"Detalle en USD"}),e.jsxs("table",{className:"table table-striped table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left w-75",children:"Concepto"}),e.jsx("th",{className:"text-left w-75",children:"Valor"})]})}),e.jsx("tbody",{children:(f=a.cotizacion.detalles)==null?void 0:f.filter(l=>l.moneda===V.USD).map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.nombre}),e.jsxs("td",{children:[l.moneda,". ",z(l.valor)]})]},l.nombre))})]}),e.jsx(c,{orientation:"left",children:"Detalle en GTQ"}),e.jsxs("table",{className:"table table-striped table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left w-75",children:"Concepto"}),e.jsx("th",{className:"text-left w-75",children:"Valor"})]})}),e.jsx("tbody",{children:(j=a.cotizacion.detalles)==null?void 0:j.filter(l=>l.moneda===V.GTQ).map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.nombre}),e.jsxs("td",{children:[l.moneda,". ",z(l.valor)]})]},l.nombre))})]}),e.jsx(c,{orientation:"left",children:"Historico"}),e.jsxs("table",{className:"table table-striped table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Fecha"}),e.jsx("th",{className:"text-left",children:"Usuario"}),e.jsx("th",{className:"text-left",children:"Cliente"}),e.jsx("th",{className:"text-left",children:"Descripcion"}),e.jsx("th",{className:"text-left",children:"Archivo"}),e.jsx("th",{className:"text-left",children:"Estado"})]})}),e.jsx("tbody",{children:a.historial_vechiculo.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.fecha_creacion}),e.jsx("td",{children:l.usuario.nombre}),e.jsx("td",{children:l.cliente.cliente}),e.jsx("td",{children:l.descripcion}),e.jsx("td",{children:l.archivo}),e.jsx("td",{children:l.estado_importacion.estado_importacion})]},l.id_historial_importacion))})]})]})},xe=()=>{const a=G(t=>t.device),{lote:d}=R(),u=$(),[g,N]=r.useState([]),[x,h]=r.useState([]),[m,v]=r.useState(W),[o,b]=r.useState({data:!1,services:!1}),[n,f]=r.useState({pagination:{current:1,pageSize:250}}),[j,l]=r.useState(""),[F,E]=r.useState(!1),y=(t,s)=>b({...o,[t]:s}),O=(t,s,i)=>{var p;f({pagination:t,filters:s,sortOrder:Array.isArray(i)?void 0:i.order,sortField:Array.isArray(i)?void 0:i.field}),t.pageSize!==((p=n.pagination)==null?void 0:p.pageSize)&&h([])},S=t=>{y("services",!0),Z(t).then(s=>{v(s),E(!0)}).catch(s=>_.error(`Error http get vehicles: ${s.message}`)).finally(()=>y("services",!1))},I=()=>{var t,s;y("data",!0),X({...n,current:(t=n.pagination)==null?void 0:t.current,pageSize:(s=n.pagination)==null?void 0:s.pageSize,filter:j,sortOrder:n.sortOrder==="descend"?"DESC":"ASC"}).then(i=>{if(h(i.data),f({...n,pagination:{...n.pagination,total:i.total}}),d){const p=i.data.find(A=>A.cotizacion.lote===d);p&&S(p.id_vehiculo),u(`/${T.PRIVATE}/${T.VEHICLES}`,{replace:!0})}}).catch(i=>_.error(`Error http get vehicles: ${i.message}`)).finally(()=>y("data",!1))};return r.useEffect(()=>{Q().then(t=>N(t==null?void 0:t.filter(s=>s.estado))).catch(t=>_.error(`Error http get customers: ${t.message}}`))},[]),r.useEffect(()=>{I()},[JSON.stringify(n),j]),e.jsxs("div",{className:"h-100 flex flex-column p-3",children:[e.jsxs("div",{className:"flex flex-md-column gap-3 justify-between items-end mb-3",children:[e.jsxs("div",{className:"flex flex-column w-md-100",children:[e.jsx("label",{htmlFor:"cliente",children:"Cliente"}),e.jsx(U,{placeholder:"Selecciones una opción",options:g.filter(t=>t.estado).map(t=>({label:t.cliente,value:t.id_cliente})),onChange:t=>l(t),allowClear:!0,style:{minWidth:200}})]}),e.jsxs("div",{className:"flex flex-row gap-2 items-center w-md-100",children:[e.jsx(L,{title:"Recargar",children:e.jsx(w,{type:"text",htmlType:"button",icon:e.jsx(C.Reload,{}),onClick:()=>I()})}),e.jsx(Y,{onSearch:t=>l(t),onReset:()=>l("")})]}),e.jsx(w,{type:"primary",htmlType:"button",onClick:()=>{},className:"w-md-100",children:"Agregar"})]}),a?e.jsx(H,{dataSource:x,loading:o.data,renderItem:t=>{var s,i;return e.jsxs("div",{className:"item-list",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Cliente: "})," ",(s=t.cotizacion.cliente)==null?void 0:s.cliente]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Vendedor: "})," ",(i=t.cotizacion.vendedor)==null?void 0:i.nombre]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Estado: "})," ",t.estado?"Activo":"Inactivo"]}),e.jsx(w,{type:"link",danger:!0,htmlType:"button",icon:e.jsx(C.Edit,{}),onClick:()=>S(t.id_vehiculo),children:"Editar"})]})]},t.id_vehiculo)}}):e.jsx(q,{size:"small",rowClassName:(t,s)=>s%2===0?"table-row-light":"table-row-dark",pagination:{position:["none","bottomRight"],...n.pagination,showSizeChanger:!0,pageSizeOptions:[50,100,250,500]},onChange:O,className:"table",loading:o.data,showSorterTooltip:!1,rowKey:"id_vehiculo",dataSource:x,columns:[{title:"No",dataIndex:"id_vehiculo",sorter:!0},{title:"Fecha",dataIndex:"fecha_creacion",ellipsis:!0,sorter:!0,render:t=>e.jsx("span",{children:B(t,"DD/MM/YYYY")})},{title:"Loter",dataIndex:"lote",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>e.jsx("span",{children:s==null?void 0:s.lote})},{title:"Vendedor",dataIndex:"vendedor",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>{var i;return e.jsx("span",{children:(i=s==null?void 0:s.vendedor)==null?void 0:i.nombre})}},{title:"Cliente",dataIndex:"cliente",ellipsis:!0,sorter:!0,render:(t,{cotizacion:s})=>{var i;return e.jsx("span",{children:(i=s==null?void 0:s.cliente)==null?void 0:i.cliente})}},{title:"Marca y Modelo",dataIndex:"cotizacion",ellipsis:!0,render:t=>e.jsxs("span",{children:[t.marca," - ",t.modelo]})},{title:"Estado",dataIndex:"estado_importacion",sorter:!0,render:t=>e.jsx("span",{children:t.estado_importacion})},{title:"Opciones",dataIndex:"operacion",width:80,render:(t,s)=>e.jsx(w,{style:{width:40},icon:e.jsx(C.Edit,{}),type:"text",size:"small",onClick:()=>S(s.id_vehiculo),children:"Ver"})}]}),e.jsx(J,{open:F,title:e.jsxs("h3",{children:["Vehiculo ",e.jsx(k,{color:"success",children:m.estado_importacion.estado_importacion})]}),footer:null,onCancel:()=>E(!1),centered:!0,destroyOnClose:!0,width:1200,children:e.jsx(ee,{vehicle:m})})]})};export{xe as Vehicles};
